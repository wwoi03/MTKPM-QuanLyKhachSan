@{
	Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

<style>
	#calendar {
		max-width: 100%;
	}

	.fc-datagrid-body td {
		cursor: pointer;
	}

	.fc .fc-toolbar.fc-header-toolbar {
		padding: 0;
	}

	.fc .fc-button-primary {
		background-color: #007CF9;
		border-color: #007CF9;
		color: #fff;
	}

	.fc .fc-button-primary:hover {
		background: #0069D4;
		border-color: #0069D4;
	}

	.fc .fc-button-primary:disabled {
		background-color: #59AAFB;
		border-color: #59AAFB;
		color: #F7FBFF;
	}

	.fc-btnBooking-button,
	.fc-btnExportFileExcel-button {
		background-color: #009688 !important;
		border-color: #009688 !important;
		color: #fff !important;
	}

	#calendar thead th:last-child .fc-scroller,
	#calendar .fc-scroller.fc-scroller-liquid-absolute {
		overflow: scroll !important;
	}
</style>

<div class="main-container d-flex">
	<!-- Nội dung bên trái -->
	<div class="left-panel col-8 pl-0 pr-0">
		<!-- Thanh navbar -->
		<nav class="panel-navbar">
			<ul class="d-flex flex-row justify-content-between nav-container">
				<li class="nav-item active" id="month-view">
					<i class="fa-solid fa-bed nav-icon" style="color: #68CBF8"></i>
					<span class="">Lịch theo phòng</span>
				</li>

				<li class="nav-item" id="week-view">
					<i class="fa-solid fa-calendar-week nav-icon" style="color: #66C0B8"></i>
					<span class="">Lịch theo tháng</span>
				</li>

				<li class="nav-item" id="day-view">
					<i class="fa-solid fa-calendar-day nav-icon" style="color: #FF9A7A"></i>
					<span class="">Lịch theo ngày</span>
				</li>

				<li class="nav-item">
					<i class="fa-sharp fa-solid fa-magnifying-glass nav-icon" style="color: #68CBF8"></i>
					<span class="">Tìm kiếm</span>
				</li>
			</ul>

			<div class="nav-line"></div>
		</nav>

		<!-- THE CALENDAR -->
		<div style="padding: 24px">
			<div id="calendar" style="margin: 0px"></div>
		</div>
	</div>

	<!-- Nội dung bên phải -->
	<div class="right-panel col-4 pl-0 pr-0">
		<form method="post" action="BookRoom/Create">
			<!-- Lưu đặt phòng -->
			<div class="panel-save d-flex justify-content-between align-items-center">
				<span>Thêm mới</span>

				<div class="">
					<input type="submit" value="Lưu" />
				</div>
			</div>

			<!-- Form -->
			<div class="panel-form">
				<!-- Thông tin -->
				<div class="panel-form-info">
					<!-- Tên khách hàng -->
					<div class="panel-form-item">
						<h5 class="panel-form-title">Họ và tên khách hàng</h5>
						<input class="panel-form-input" name="nameCustomer" type="text" value="" />
					</div>

					<!-- Số điện thoại -->
					<div class="panel-form-item">
						<h5 class="panel-form-title">Số điện thoại</h5>
						<input class="panel-form-input" name="phoneCustomer" type="number" value="" />
					</div>

					<!-- CCCD -->
					<div class="panel-form-item">
						<h5 class="panel-form-title">Căn cước công dân</h5>
						<input class="panel-form-input" name="cardId" type="number" value="" />
					</div>

					<!-- Ngày -->
					<div class="panel-form-item">
						<div class="panel-form-height">
							<div class="panel-form-height-item">
								<h5 class="panel-form-title">Ngày nhận phòng</h5>
								<input class="panel-form-input" name="CheckInDate" type="date" />
							</div>

							<div class="panel-form-height-item">
								<h5 class="panel-form-title">Ngày trả phòng</h5>
								<input class="panel-form-input" name="CheckOutDate" type="date" />
							</div>
						</div>
					</div>

					<!-- Tiền trả trước -->
					<div class="panel-form-item">
						<h5 class="panel-form-title">Tiền trả trước</h5>
						<input class="panel-form-input" type="number" name="PrePayment" placeholder="0.000 đ" />
					</div>

					<!-- Ghi chú -->
					<div class="panel-form-item">
						<h5 class="panel-form-title">Ghi chú</h5>
						<input class="panel-form-input" type="text" name="Note" value="" placeholder="" />
					</div>
				</div>

				<!-- Phòng -->
				<div class="panel-form-room">
					<div class="panel-form-room-item">
						<h5 class="panel-form-title">Thêm phòng</h5>

						<div class="panel-form-add-room">
							<i class="fa-solid fa-square-plus"></i>
							<p class="panel-form-room-btn">Thêm phòng</p>
							<input id="list-room-string" hidden name="listRoomString" />
						</div>
					</div>
				</div>

				<!-- Danh sách phòng theo loại-->
				<div class="panel-form-roomtype">
					<div class="panel-form-roomtype-item">
						<div class="panel-form-roomtype-title">Phòng siêu vip</div>

						<div class="panel-form-roomtype-render">
							<div class="d-flex">
								<div class="row p-0 container-fluid panel-form-roomtype-render-list">
									<div value="101" class="col-2 panel-form-roomtype-render-item">
										101
									</div>

									<div value="102" class="col-2 panel-form-roomtype-render-item">
										102
									</div>

									<div value="103" class="col-2 panel-form-roomtype-render-item">
										103
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="panel-form-roomtype-item">
						<div class="panel-form-roomtype-title">Phòng siêu vip</div>

						<div class="panel-form-roomtype-render">
							<div class="d-flex">
								<div class="row p-0 container-fluid panel-form-roomtype-render-list">
									<div value="104" class="col-2 panel-form-roomtype-render-item">
										104
									</div>

									<div value="105" class="col-2 panel-form-roomtype-render-item">
										105
									</div>

									<div value="106" class="col-2 panel-form-roomtype-render-item">
										106
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="panel-cancel-room">
				<a>Hủy đặt phòng</a>
			</div>
		</form>
	</div>
</div>

<script>
	document.addEventListener('DOMContentLoaded', function () {
		main();

		function main() {
			switchTabs();
			renderFullCallendar(null);
		}

		// M: Xử lý chuyển tab
		function switchTabs(calendar) {
			var tabActive = document.querySelector(".nav-item.active");
			var navLine = document.querySelector(".panel-navbar .nav-line");

			// Chuyển line
			function LineUpdate(tab) {
				navLine.style.left = tab.offsetLeft + "px";
				navLine.style.width = tab.offsetWidth + "px";
			}

			LineUpdate(tabActive);

			$(".nav-container .nav-item").click(function () {
				document.querySelector(".nav-item.active").classList.remove("active");

				LineUpdate(this);

				this.classList.add("active");
			});

			// Bắt sự kiện click của các item trong navbar
			$(".nav-container li").click(function () {
				// Lấy id của item được click
				var view = $(this).attr("id");

				// Th	ay đổi hiển thị của FullCalendar tùy theo trạng thái mới
				if (view === "month-view") {
					calendar.changeView("resourceTimelineMonth");
				} else if (view === "week-view") {
					calendar.changeView("dayGridMonth");
				} else if (view === "day-view") {
					calendar.changeView("timeGridWeek");
				}
			});
		}

		// hiển thị giao diện Calendar
		function renderFullCallendar(data) {
			var calendarEl = document.getElementById('calendar');

			var calendar = new FullCalendar.Calendar(calendarEl, {
				schedulerLicenseKey: 'GPL-My-Project-Is-Open-Source',
				now: new Date(),
				aspectRatio: 1.8,
				scrollTime: '00:00',
				editable: true,
				locale: 'vi',
				initialView: 'resourceTimelineMonth',
				initialDate: new Date(),
				resourceAreaHeaderContent: 'Phòng',
				headerToolbar: {
					left: 'prev,next today',
					center: 'title',
					right: 'btnExportFileExcel btnBooking'
					//right: 'resourceTimelineMonth,resourceTimelineThreeDays,timeGridWeek,dayGridMonth'
				},
				buttonText: {
					today: 'Hôm nay',
				},
				resourceAreaWidth: '10%', // Chỉnh độ rộng của khu vực resource
				customButtons: {
					btnBooking: {
						text: 'Đặt phòng',
						click: function() {
							var title = prompt('Room name');
							if (title) {
								calendar.addResource({ title: title });
							}
						}
					},
					btnExportFileExcel: {
						text: 'Xuất excel',
						click: function() {
							var title = prompt('Room name');
							if (title) {
								calendar.addResource({ title: title });
							}
						}
					}
				},
				resourceLabelDidMount: function(arg) {
					var resource = arg.resource;

					arg.el.addEventListener('click', function() {
						if (confirm('Are you sure you want to delete ' + resource.title + '?')) {
							resource.remove();
							}
						});
				},
				eventClick: function(info) {
					alert(
						'Title: ' + info.event.title + '\n' + 
						'Start: ' + info.event.start + '\n' + 
						'End: ' + info.event.end);

					// change the border color just for fun
					info.el.style.borderColor = 'red';
				},
				resources: [
					{ id: '101', title: '101' },
					{ id: '102', title: '102', eventColor: 'green' },
					{ id: '103', title: '103', eventColor: 'orange' },
					{ id: '104', title: '104', eventColor: 'blue' },
					{ id: '105', title: '105' },
					{ id: '106', title: '106', eventColor: 'red' },
					{ id: '107', title: '107' },
					{ id: '108', title: '108' },
					{ id: '109', title: '109' },
					{ id: '110', title: '110' },
					{ id: '111', title: '111' },
					{ id: '112', title: '112' },
					{ id: '113', title: '113' },
					{ id: '114', title: '114' },
					{ id: '115', title: '115' },
					{ id: '116', title: '116' },
					{ id: '117', title: '117' },
					{ id: '118', title: '118' },
					{ id: '119', title: '119' },
					{ id: '120', title: '120' },
					{ id: '121', title: '121' },
					{ id: '122', title: '122' },
					{ id: '123', title: '123' },
					{ id: '124', title: '124' },
					{ id: '125', title: '125' },
					{ id: '126', title: '126' }
				],
				events: [
					{ id: '1', resourceId: '102', start: '2024-01-02', end: '2024-01-02', title: 'Đào Công Tuấn' },
					{ id: '2', resourceId: '103', start: '2024-01-02', end: '2024-01-02', title: 'Nguyễn Thành An' },
					{ id: '3', resourceId: '104', start: '2024-01-01', end: '2024-01-03', title: 'Nguyễn Văn Xên' },
					{ id: '4', resourceId: '105', start: '2024-01-02', end: '2024-01-02', title: 'Diệp Minh Quân' },
					{ id: '5', resourceId: '108', start: '2024-01-02', end: '2024-01-04', title: 'Bùi Thanh Tùng' }
				]
			});

			switchTabs(calendar);

			calendar.render();
		}
	});
</script>